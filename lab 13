import pandas as pd
import time

chunks = pd.read_csv("day13_large_users (1).csv", chunksize=2001, header=None)

total_rows = 0
total_income = 0.0

start_time = time.perf_counter()

for block in chunks:
    block = block.copy()
    block.columns = ["age", "income", "score", "city"]  # if there are 4 columns

    income_notnull = block.dropna(subset=["income"])
    total_rows += len(income_notnull)
    total_income += income_notnull["income"].sum()

    block["income_normalized"] = block["income"].apply(
        lambda x: x / total_income if pd.notna(x) else x
    )

    age_notnull = block.dropna(subset=["age"])
    print(age_notnull)

elapsed = time.perf_counter() - start_time

print("Rows cleaned:", total_rows)
print("Income sum:", total_income)
print("Elapsed time:", elapsed)
